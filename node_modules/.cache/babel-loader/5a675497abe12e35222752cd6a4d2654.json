{"ast":null,"code":"var base58 = require('bs58');\n\nvar createHash = require('create-hash');\n\nfunction encode(payload, version) {\n  if (Array.isArray(payload) || payload instanceof Uint8Array) {\n    payload = new Buffer(payload);\n  }\n\n  var buf;\n\n  if (version != null) {\n    if (typeof version === 'number') {\n      version = new Buffer([version]);\n    }\n\n    buf = Buffer.concat([version, payload]);\n  } else {\n    buf = payload;\n  }\n\n  var checksum = sha256x2(buf).slice(0, 4);\n  var result = Buffer.concat([buf, checksum]);\n  return base58.encode(result);\n}\n\nfunction decode(base58str, version) {\n  var arr = base58.decode(base58str);\n  var buf = new Buffer(arr);\n  var versionLength;\n\n  if (version == null) {\n    versionLength = 0;\n  } else {\n    if (typeof version === 'number') version = new Buffer([version]);\n    versionLength = version.length;\n    var versionCompare = buf.slice(0, versionLength);\n\n    if (versionCompare.toString('hex') !== version.toString('hex')) {\n      throw new Error('Invalid version');\n    }\n  }\n\n  var checksum = buf.slice(-4);\n  var endPos = buf.length - 4;\n  var bytes = buf.slice(0, endPos);\n  var newChecksum = sha256x2(bytes).slice(0, 4);\n\n  if (checksum.toString('hex') !== newChecksum.toString('hex')) {\n    throw new Error('Invalid checksum');\n  }\n\n  return bytes.slice(versionLength);\n}\n\nfunction isValid(base58str, version) {\n  try {\n    decode(base58str, version);\n  } catch (e) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction createEncoder(version) {\n  return function (payload) {\n    return encode(payload, version);\n  };\n}\n\nfunction createDecoder(version) {\n  return function (base58str) {\n    return decode(base58str, version);\n  };\n}\n\nfunction createValidator(version) {\n  return function (base58str) {\n    return isValid(base58str, version);\n  };\n}\n\nfunction sha256x2(buffer) {\n  var sha = createHash('sha256').update(buffer).digest();\n  return createHash('sha256').update(sha).digest();\n}\n\nmodule.exports = {\n  encode: encode,\n  decode: decode,\n  isValid: isValid,\n  createEncoder: createEncoder,\n  createDecoder: createDecoder,\n  createValidator: createValidator\n};","map":{"version":3,"sources":["F:/7color/node_modules/coinstring/lib/coinstring.js"],"names":["base58","require","createHash","encode","payload","version","Array","isArray","Uint8Array","Buffer","buf","concat","checksum","sha256x2","slice","result","decode","base58str","arr","versionLength","length","versionCompare","toString","Error","endPos","bytes","newChecksum","isValid","e","createEncoder","createDecoder","createValidator","buffer","sha","update","digest","module","exports"],"mappings":"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","sourcesContent":["var base58 = require('bs58')\r\nvar createHash = require('create-hash')\r\n\r\nfunction encode (payload, version) {\r\n  if (Array.isArray(payload) || payload instanceof Uint8Array) {\r\n    payload = new Buffer(payload)\r\n  }\r\n\r\n  var buf\r\n  if (version != null) {\r\n    if (typeof version === 'number') {\r\n      version = new Buffer([version])\r\n    }\r\n    buf = Buffer.concat([version, payload])\r\n  } else {\r\n    buf = payload\r\n  }\r\n\r\n  var checksum = sha256x2(buf).slice(0, 4)\r\n  var result = Buffer.concat([buf, checksum])\r\n  return base58.encode(result)\r\n}\r\n\r\nfunction decode (base58str, version) {\r\n  var arr = base58.decode(base58str)\r\n  var buf = new Buffer(arr)\r\n  var versionLength\r\n\r\n  if (version == null) {\r\n    versionLength = 0\r\n  } else {\r\n    if (typeof version === 'number') version = new Buffer([version])\r\n\r\n    versionLength = version.length\r\n    var versionCompare = buf.slice(0, versionLength)\r\n    if (versionCompare.toString('hex') !== version.toString('hex')) {\r\n      throw new Error('Invalid version')\r\n    }\r\n  }\r\n\r\n  var checksum = buf.slice(-4)\r\n  var endPos = buf.length - 4\r\n  var bytes = buf.slice(0, endPos)\r\n\r\n  var newChecksum = sha256x2(bytes).slice(0, 4)\r\n  if (checksum.toString('hex') !== newChecksum.toString('hex')) {\r\n    throw new Error('Invalid checksum')\r\n  }\r\n\r\n  return bytes.slice(versionLength)\r\n}\r\n\r\nfunction isValid (base58str, version) {\r\n  try {\r\n    decode(base58str, version)\r\n  } catch (e) {\r\n    return false\r\n  }\r\n\r\n  return true\r\n}\r\n\r\nfunction createEncoder (version) {\r\n  return function (payload) {\r\n    return encode(payload, version)\r\n  }\r\n}\r\n\r\nfunction createDecoder (version) {\r\n  return function (base58str) {\r\n    return decode(base58str, version)\r\n  }\r\n}\r\n\r\nfunction createValidator (version) {\r\n  return function (base58str) {\r\n    return isValid(base58str, version)\r\n  }\r\n}\r\n\r\nfunction sha256x2 (buffer) {\r\n  var sha = createHash('sha256').update(buffer).digest()\r\n  return createHash('sha256').update(sha).digest()\r\n}\r\n\r\nmodule.exports = {\r\n  encode: encode,\r\n  decode: decode,\r\n  isValid: isValid,\r\n  createEncoder: createEncoder,\r\n  createDecoder: createDecoder,\r\n  createValidator: createValidator\r\n}\r\n"]},"metadata":{},"sourceType":"script"}