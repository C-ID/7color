{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _ = require(\"lodash\");\n\nvar calldata_1 = require(\"../calldata/calldata\");\n\nvar raw_calldata_1 = require(\"../calldata/raw_calldata\");\n\nvar constants_1 = require(\"../utils/constants\");\n\nvar DataType =\n/** @class */\nfunction () {\n  function DataType(dataItem, factory) {\n    this._dataItem = dataItem;\n    this._factory = factory;\n  }\n\n  DataType.prototype.getDataItem = function () {\n    return this._dataItem;\n  };\n\n  DataType.prototype.getFactory = function () {\n    return this._factory;\n  };\n\n  DataType.prototype.encode = function (value, rules, selector) {\n    var rules_ = rules === undefined ? constants_1.constants.DEFAULT_ENCODING_RULES : rules;\n    var calldata = new calldata_1.Calldata(rules_);\n\n    if (selector !== undefined) {\n      calldata.setSelector(selector);\n    }\n\n    var block = this.generateCalldataBlock(value);\n    calldata.setRoot(block);\n    var encodedCalldata = calldata.toString();\n    return encodedCalldata;\n  };\n\n  DataType.prototype.decode = function (calldata, rules, selector) {\n    if (selector !== undefined && !_.startsWith(calldata, selector)) {\n      throw new Error(\"Tried to decode calldata, but it was missing the function selector. Expected prefix '\" + selector + \"'. Got '\" + calldata + \"'.\");\n    }\n\n    var hasSelector = selector !== undefined;\n    var rawCalldata = new raw_calldata_1.RawCalldata(calldata, hasSelector);\n    var rules_ = rules === undefined ? constants_1.constants.DEFAULT_DECODING_RULES : rules;\n    var value = rawCalldata.getSizeInBytes() > 0 ? this.generateValue(rawCalldata, rules_) : this.getDefaultValue(rules_);\n    return value;\n  };\n\n  DataType.prototype.decodeAsArray = function (returndata, rules) {\n    var value = this.decode(returndata, rules);\n    var valuesAsArray = _.isObject(value) ? _.values(value) : [value];\n    return valuesAsArray;\n  };\n\n  DataType.prototype.getSignature = function (isDetailed) {\n    if (_.isEmpty(this._dataItem.name) || !isDetailed) {\n      return this.getSignatureType();\n    }\n\n    var name = this.getDataItem().name;\n    var lastIndexOfScopeDelimiter = name.lastIndexOf('.');\n    var isScopedName = lastIndexOfScopeDelimiter !== undefined && lastIndexOfScopeDelimiter > 0;\n    var shortName = isScopedName ? name.substr(lastIndexOfScopeDelimiter + 1) : name;\n    var detailedSignature = shortName + \" \" + this.getSignatureType();\n    return detailedSignature;\n  };\n\n  return DataType;\n}();\n\nexports.DataType = DataType;","map":{"version":3,"sources":["../../../../src/abi_encoder/abstract_data_types/data_type.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar _ = require(\"lodash\");\r\nvar calldata_1 = require(\"../calldata/calldata\");\r\nvar raw_calldata_1 = require(\"../calldata/raw_calldata\");\r\nvar constants_1 = require(\"../utils/constants\");\r\nvar DataType = /** @class */ (function () {\r\n    function DataType(dataItem, factory) {\r\n        this._dataItem = dataItem;\r\n        this._factory = factory;\r\n    }\r\n    DataType.prototype.getDataItem = function () {\r\n        return this._dataItem;\r\n    };\r\n    DataType.prototype.getFactory = function () {\r\n        return this._factory;\r\n    };\r\n    DataType.prototype.encode = function (value, rules, selector) {\r\n        var rules_ = rules === undefined ? constants_1.constants.DEFAULT_ENCODING_RULES : rules;\r\n        var calldata = new calldata_1.Calldata(rules_);\r\n        if (selector !== undefined) {\r\n            calldata.setSelector(selector);\r\n        }\r\n        var block = this.generateCalldataBlock(value);\r\n        calldata.setRoot(block);\r\n        var encodedCalldata = calldata.toString();\r\n        return encodedCalldata;\r\n    };\r\n    DataType.prototype.decode = function (calldata, rules, selector) {\r\n        if (selector !== undefined && !_.startsWith(calldata, selector)) {\r\n            throw new Error(\"Tried to decode calldata, but it was missing the function selector. Expected prefix '\" + selector + \"'. Got '\" + calldata + \"'.\");\r\n        }\r\n        var hasSelector = selector !== undefined;\r\n        var rawCalldata = new raw_calldata_1.RawCalldata(calldata, hasSelector);\r\n        var rules_ = rules === undefined ? constants_1.constants.DEFAULT_DECODING_RULES : rules;\r\n        var value = rawCalldata.getSizeInBytes() > 0 ? this.generateValue(rawCalldata, rules_) : this.getDefaultValue(rules_);\r\n        return value;\r\n    };\r\n    DataType.prototype.decodeAsArray = function (returndata, rules) {\r\n        var value = this.decode(returndata, rules);\r\n        var valuesAsArray = _.isObject(value) ? _.values(value) : [value];\r\n        return valuesAsArray;\r\n    };\r\n    DataType.prototype.getSignature = function (isDetailed) {\r\n        if (_.isEmpty(this._dataItem.name) || !isDetailed) {\r\n            return this.getSignatureType();\r\n        }\r\n        var name = this.getDataItem().name;\r\n        var lastIndexOfScopeDelimiter = name.lastIndexOf('.');\r\n        var isScopedName = lastIndexOfScopeDelimiter !== undefined && lastIndexOfScopeDelimiter > 0;\r\n        var shortName = isScopedName ? name.substr(lastIndexOfScopeDelimiter + 1) : name;\r\n        var detailedSignature = shortName + \" \" + this.getSignatureType();\r\n        return detailedSignature;\r\n    };\r\n    return DataType;\r\n}());\r\nexports.DataType = DataType;\r\n//# sourceMappingURL=data_type.js.map"]},"metadata":{},"sourceType":"script"}